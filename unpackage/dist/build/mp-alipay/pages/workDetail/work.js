(my["webpackJsonp"]=my["webpackJsonp"]||[]).push([["pages/workDetail/work"],{1856:function(t,e,n){"use strict";var i=n("aabf"),a=n.n(i);a.a},"1c25":function(t,e,n){"use strict";(function(t){function i(t){return s(t)||r(t)||o(t)||a()}function a(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function o(t,e){if(t){if("string"===typeof t)return u(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(n):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?u(t,e):void 0}}function r(t){if("undefined"!==typeof Symbol&&Symbol.iterator in Object(t))return Array.from(t)}function s(t){if(Array.isArray(t))return u(t)}function u(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,i=new Array(e);n<e;n++)i[n]=t[n];return i}Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var c=function(){n.e("components/mx-datepicker/mx-datepicker").then(function(){return resolve(n("8c12"))}.bind(null,n)).catch(n.oe)},h=function(){n.e("components/uni-drawer/uni-drawer").then(function(){return resolve(n("b33b"))}.bind(null,n)).catch(n.oe)},l={components:{MxDatePicker:c,uniDrawer:h},onLoad:function(t){console.log(t),t.workItem&&(this.workItem=JSON.parse(decodeURIComponent(t.workItem)),this.finishValue=parseFloat(this.workItem.canReportQty)<parseFloat(this.workItem.plannedqty)?this.workItem.canReportQty:this.workItem.plannedqty)},onShow:function(){t.setNavigationBarTitle({title:this.i18n.publicText.Workorder_Title_OrderDetail})},data:function(){return{workItem:null,finishShowClearIcon:!1,failShowClearIcon:!1,finishValue:"",failValue:0,datetime:"",type:"rangetime",showPicker:!1,showLeft:!1,changeResArr:[]}},mounted:function(){console.log(this.workItem),this.datetime=this.getNowDateTime()},computed:{i18n:function(){return this.$t("message")}},methods:{closeDrawer:function(){this.showLeft=!1},finishClearIcon:function(){this.finishValue="",this.finishShowClearIcon=!1},failClearIcon:function(){this.failValue="",this.failShowClearIcon=!1},FinishClearInput:function(t){this.finishValue=t.detail.value,t.detail.value.length>0?this.finishShowClearIcon=!0:this.finishShowClearIcon=!1},FailClearInput:function(t){this.failValue=t.detail.value,t.detail.value.length>0?this.failShowClearIcon=!0:this.failShowClearIcon=!1},onShowDatePicker:function(t){this.type=t,this.showPicker=!0},onSelected:function(t){this.showPicker=!1,t&&(this[this.type]=t.value)},changeRes:function(){if(2!=this.workItem.taskFinishState){this.showLeft=!0;t.getStorageSync("UserGuid"),t.getStorageSync("UserEmpID");var e=this;this.$HTTP({url:"GetCanChangeResList",data:{bean:JSON.stringify(this.workItem)}}).then((function(t){var n;e.changeResArr=[],(n=e.changeResArr).push.apply(n,i(t.data))}))}else t.showToast({title:"该工单在生产不能切换设备",icon:"none"})},getNowDateTime:function(){var t=new Date,e=t.getFullYear(),n=t.getMonth()+1>9?t.getMonth()+1:"0"+(t.getMonth()+1),i=t.getDate()>9?t.getDate():"0"+t.getDate(),a=t.getHours()>9?t.getHours():"0"+t.getHours(),o=t.getMinutes()>9?t.getMinutes():"0"+t.getMinutes();return e+"/"+n+"/"+i+" "+a+":"+o},btnClick:function(){var e=t.getStorageSync("userInfo");if(this.workItem.mesOperator=e["userName"],this.workItem.mesOpName=this.workItem.pmOpName,this.workItem.mesResName=this.workItem.pmResName,this.workItem.canReport)if(0==this.workItem.taskFinishState)this.pullData("BeginChange");else if(1==this.workItem.taskFinishState)this.pullData("EndChange");else if(2==this.workItem.taskFinishState){if(console.log(this.finishValue,this.failValue),console.log(this.datetime),console.log(this.workItem.canReportQty),parseInt(this.finishValue)+parseInt(this.failValue)>this.workItem.canReportQty)return void t.showToast({title:"完成数加不良数不能超过工单总数",icon:"none"});this.workItem.finishedQty=this.finishValue,this.workItem.failedQty=parseInt(this.failValue),this.workItem.reportTime=this.datetime,this.pullData("Report")}else 3==this.workItem.taskFinishState&&this.pullData("ResumeOrder")},parseBtn:function(){var e=t.getStorageSync("userInfo");this.workItem.mesOperator=e["userName"],this.workItem.mesOpName=this.workItem.pmOpName,this.workItem.mesResName=this.workItem.pmResName,this.pullData("PauseOrder",!0)},pullData:function(e,n){var i=this;this.$HTTP({url:e,data:{bean:JSON.stringify(this.workItem)}}).then((function(e){if(console.log(e),n)return i.workItem.taskFinishState=3,void t.navigateBack({delta:1,animationType:"pop-out",animationDuration:200});0==i.workItem.taskFinishState?i.workItem.taskFinishState=1:1==i.workItem.taskFinishState?i.workItem.taskFinishState=2:3==i.workItem.taskFinishState&&(i.workItem.taskFinishState=0),t.navigateBack({delta:1,animationType:"pop-out",animationDuration:200})}))},enterChangeRes:function(e){this.workItem.changeResName=e;this.$HTTP({url:"ChangeResource",data:{bean:JSON.stringify(this.workItem)}}).then((function(e){e.data&&t.navigateBack({delta:1,animationType:"pop-out",animationDuration:200})}))},changeDayShift:function(){var e=t.getStorageSync("userInfo");this.workItem.mesOperator=e["userName"],this.workItem.mesOpName=this.workItem.pmOpName,this.workItem.mesResName=this.workItem.pmResName;var n=this;t.showModal({title:"确定换班?",success:function(e){e.confirm&&n.$HTTP({url:"EndWorking",data:{bean:JSON.stringify(n.workItem)}}).then((function(e){e.data&&t.showToast({title:"换班成功",complete:function(){t.navigateBack({animationDuration:2e3})}})}))}})}}};e.default=l}).call(this,n("c11b")["default"])},"936a":function(t,e,n){"use strict";var i={uniDrawer:function(){return n.e("components/uni-drawer/uni-drawer").then(n.bind(null,"b33b"))},uniList:function(){return n.e("components/uni-list/uni-list").then(n.bind(null,"437d"))},uniListItem:function(){return n.e("components/uni-list-item/uni-list-item").then(n.bind(null,"8ff0"))}},a=function(){var t=this,e=t.$createElement,n=(t._self._c,{hoverBtn:t.workItem.canReport}),i={hoverBtn:t.workItem.canReport},a={hoverBtn:t.workItem.canReport},o={hoverBtn:t.workItem.canReport};t.$mp.data=Object.assign({},{$root:{a0:n,a1:i,a2:a,a3:o}})},o=[];n.d(e,"b",(function(){return a})),n.d(e,"c",(function(){return o})),n.d(e,"a",(function(){return i}))},aabf:function(t,e,n){},b143:function(t,e,n){"use strict";(function(t){n("8b56");i(n("66fd"));var e=i(n("f858"));function i(t){return t&&t.__esModule?t:{default:t}}t(e.default)}).call(this,n("c11b")["createPage"])},f858:function(t,e,n){"use strict";n.r(e);var i=n("936a"),a=n("f92c");for(var o in a)"default"!==o&&function(t){n.d(e,t,(function(){return a[t]}))}(o);n("1856");var r,s=n("f0c5"),u=Object(s["a"])(a["default"],i["b"],i["c"],!1,null,"36cf39c6",null,!1,i["a"],r);e["default"]=u.exports},f92c:function(t,e,n){"use strict";n.r(e);var i=n("1c25"),a=n.n(i);for(var o in i)"default"!==o&&function(t){n.d(e,t,(function(){return i[t]}))}(o);e["default"]=a.a}},[["b143","common/runtime","common/vendor"]]]);